---
resources:
- name: list-open-prs
  type: git
  source:
    uri: https://github.com/karenc/list-open-prs.git

jobs:
- name: job-list-open-prs
  public: true
  plan:
  - get: list-open-prs
  - task: generate-list
    config:
      platform: linux
      image_resource:
        type: docker-image
        source: {repository: python, tag: 3.7}

      inputs:
      - name: list-open-prs
      outputs:
      - name: open-prs

      run:
        path: /bin/bash
        args: ["-c", "ORGANIZATION=openstax list-open-prs/list_open_prs.py > open-prs/out"]
      params:
        GITHUB_BEARER_TOKEN: ((github-bearer-token))

  - task: show-list
    config:
      platform: linux
      image_resource:
        type: docker-image
        source: {repository: busybox}

      inputs:
      - name: open-prs

      run:
        path: cat
        args: [open-prs/out]
